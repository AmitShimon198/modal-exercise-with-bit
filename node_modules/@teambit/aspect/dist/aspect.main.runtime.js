"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("core-js/modules/es.array.iterator.js");

require("core-js/modules/es.promise.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.AspectMain = void 0;

function _defineProperty2() {
  const data = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

  _defineProperty2 = function () {
    return data;
  };

  return data;
}

function _aspectLoader() {
  const data = require("@teambit/aspect-loader");

  _aspectLoader = function () {
    return data;
  };

  return data;
}

function _builder() {
  const data = require("@teambit/builder");

  _builder = function () {
    return data;
  };

  return data;
}

function _cli() {
  const data = require("@teambit/cli");

  _cli = function () {
    return data;
  };

  return data;
}

function _envs() {
  const data = require("@teambit/envs");

  _envs = function () {
    return data;
  };

  return data;
}

function _react() {
  const data = require("@teambit/react");

  _react = function () {
    return data;
  };

  return data;
}

function _generator() {
  const data = require("@teambit/generator");

  _generator = function () {
    return data;
  };

  return data;
}

function _babel() {
  const data = require("@teambit/babel");

  _babel = function () {
    return data;
  };

  return data;
}

function _compiler() {
  const data = require("@teambit/compiler");

  _compiler = function () {
    return data;
  };

  return data;
}

function _aspect() {
  const data = require("./aspect.aspect");

  _aspect = function () {
    return data;
  };

  return data;
}

function _aspect2() {
  const data = require("./aspect.env");

  _aspect2 = function () {
    return data;
  };

  return data;
}

function _coreExporter() {
  const data = require("./core-exporter.task");

  _coreExporter = function () {
    return data;
  };

  return data;
}

function _aspect3() {
  const data = require("./templates/aspect");

  _aspect3 = function () {
    return data;
  };

  return data;
}

class AspectMain {
  constructor(aspectEnv, envs) {
    this.aspectEnv = aspectEnv;
    this.envs = envs;
  }
  /**
   * compose your own aspect environment.
   */


  compose(transformers = []) {
    return this.envs.compose(this.aspectEnv, transformers);
  }

  static async provider([react, envs, builder, aspectLoader, compiler, babel, generator]) {
    const aspectEnv = envs.merge(new (_aspect2().AspectEnv)(react.reactEnv, babel, compiler), react.reactEnv);
    const coreExporterTask = new (_coreExporter().CoreExporterTask)(aspectEnv, aspectLoader);

    if (!__dirname.includes('@teambit/bit')) {
      builder.registerBuildTasks([coreExporterTask]);
    }

    envs.registerEnv(aspectEnv);
    generator.registerComponentTemplate([_aspect3().aspectTemplate]);
    return new AspectMain(aspectEnv, envs);
  }

}

exports.AspectMain = AspectMain;
(0, _defineProperty2().default)(AspectMain, "runtime", _cli().MainRuntime);
(0, _defineProperty2().default)(AspectMain, "dependencies", [_react().ReactAspect, _envs().EnvsAspect, _builder().BuilderAspect, _aspectLoader().AspectLoaderAspect, _compiler().CompilerAspect, _babel().BabelAspect, _generator().GeneratorAspect]);

_aspect().AspectAspect.addRuntime(AspectMain);

//# sourceMappingURL=aspect.main.runtime.js.map